<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>News & Recaps ‚Äî Mountain State Miles</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/main.css">
</head>
<body>

  <header>
    <nav class="navbar">
      <div class="navbar-content">
        <a href="index.html" class="navbar-brand">Mountain State Miles</a>
        <button class="mobile-menu-toggle" aria-label="Toggle menu">‚ò∞</button>
        <ul class="navbar-nav" id="main-nav">
          <li><a href="/home/index" class="navbar-link">Home</a></li>
          <li><a href="news.html" class="navbar-link active">News</a></li>
          <li><a href="/feedback" class="navbar-link">Feedback</a></li>
          <li><a href="/Track/index" class="navbar-link">Track & Field</a></li>
          <li><a href="/CrossCountry/xc" class="navbar-link">Cross Country</a></li>
          <li><a href="/weather" class="navbar-link">Weather</a></li>
        </ul>
        <button class="theme-toggle" aria-label="Switch theme">üåô</button>
      </div>
    </nav>
  </header>
  
  <main>
    <div class="page-header">
      <h1 class="page-title">üì∞ News & Recaps</h1>
      <p class="page-subtitle">Weekly summaries and automated meet analysis</p>
    </div>

    <div id="news-container">
      <div style="text-align: center; padding: 40px; color: #666;">Loading recaps...</div>
    </div>

  </main>
  
  <footer>
    <div class="row">
      <div class="footer-col">
        <h4>General</h4>
        <ul>
          <li><a href="/home/index">Home</a></li>
          <li><a href="/feedback">Feedback</a></li>
          <li><a href="/home/admin">Admin</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Track</h4>
        <ul>
          <li><a href="/Track/index.html">Home</a></li>
          <li><a href="/Track/meets.html">Meets</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <h4>Cross Country</h4>
        <ul>
          <li><a href="/CrossCountry/xc.html">Home</a></li>
          <li><a href="/CrossCountry/meets.html">Meets</a></li>
        </ul>
      </div>
    </div>
    <hr>
    <div class="row">
      <div class="footer-bottom">
        <p>&#169; 2026 Mountain State Miles ‚Äî Built by runners, for runners.</p>
      </div>
    </div>
  </footer>
  
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="/assets/theme-toggle.js"></script>
  
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCBQt9I_OSoUuTM61F-JXNBkD98f7PCJcA",
      authDomain: "mountainstatemiles-1326f.firebaseapp.com",
      databaseURL: "https://mountainstatemiles-1326f-default-rtdb.firebaseio.com",
      projectId: "mountainstatemiles-1326f",
      storageBucket: "mountainstatemiles-1326f.firebasestorage.app",
      messagingSenderId: "605911511756",
      appId: "1:605911511756:web:0e99071a816f0a39210869",
      measurementId: "G-N3DNFRQNF9"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    async function loadNews() {
      const container = document.getElementById('news-container');
      
      try {
        const snapshot = await database.ref('news').once('value');
        const news = [];
        
        snapshot.forEach(child => {
          news.push({
            id: child.key,
            ...child.val()
          });
        });

        news.sort((a, b) => {
          const dateA = new Date(a.date || 0);
          const dateB = new Date(b.date || 0);
          return dateB - dateA;
        });

        if (!news.length) {
          container.innerHTML = '<div class="no-news">No news articles yet. Check back soon!</div>';
          return;
        }

        function formatDate(dateString) {
          const date = new Date(dateString);
          return date.toLocaleDateString('en-US', {
            weekday: 'long',
            month: 'short',
            day: 'numeric',
            year: 'numeric'
          });
        }

        container.innerHTML = news.map(item => `
          <div class="news-item">
            <div class="news-header">
              <h2 class="news-title">${item.title}</h2>
              <div class="news-date">${formatDate(item.date)}</div>
            </div>
            <div class="news-meta">
              ${item.category ? `<span class="meta-tag">${item.category}</span>` : ''}
            </div>
            <div class="news-content">
              ${item.content || ''}
            </div>
          </div>
        `).join('');
      } catch (error) {
        console.error('Error loading news:', error);
        container.innerHTML = '<div style="text-align: center; padding: 40px; color: #dc3545;">‚ö†Ô∏è Error loading news. Please try again later.</div>';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      loadNews();
      
      const menuToggle = document.querySelector('.mobile-menu-toggle');
      const navMenu = document.getElementById('main-nav');
      
      if (menuToggle && navMenu) {
        menuToggle.addEventListener('click', () => {
          navMenu.classList.toggle('mobile-open');
        });
        
        document.addEventListener('click', (e) => {
          if (!navMenu.contains(e.target) && !menuToggle.contains(e.target)) {
            navMenu.classList.remove('mobile-open');
          }
        });
      }
    });
  </script>
</body>
</html>
